<advanced-accordion
  data-disabled="{{ section.settings.disabled }}"
  class="advanced-accordion__container advanced-accordion--{{ section.settings.per_row }}-per-row"
>
  {% if section.settings.disabled %}
    <div
      class="advanced-accordion"
      data-id="{{ section.id }}"
      {% if section.settings.opened %}
        open
      {% endif %}
    >
  {% else %}
    <details
      class="advanced-accordion"
      data-id="{{ section.id }}"
      {% if section.settings.opened %}
        open
      {% endif %}
    >
  {% endif %}

  {% if section.settings.disabled %}
    <div class="accordion__title">
  {% else %}
    <summary class="accordion__title">
  {% endif %}
  <h2 class="h2">{{ section.settings.title }}</h2>
  {% unless section.settings.disabled == true %}
    {% render 'thermos-icon-accorgion-none' %}
  {% endunless %}

  {% if section.settings.disabled %}
    </div>
  {% else %}
    </summary>
  {% endif %}

  <div class="accordion__content" data-accordion-block data-opened="false">
    {% for block in section.blocks %}
      <div
        class="accordion__content-block accordion__content-block--type-{{ block.type }} {% if section.settings.two_per_row_mobile %}two-per-row-mobile{% endif %} text-{{ block.settings.align_text }}"
        {{ block.shopify_attributes }}
      >
        {%- if block.type == 'text_block' -%}
          {%- if block.settings.button_link != blank -%}
            <a href="{{ block.settings.button_link }}">
          {%- endif -%}

          {% liquid
            if block.settings.image_mask != 'none'
              assign paddingValue = block.settings.image_width
            else
              assign paddingValue = block.settings.image_width | divided_by: block.settings.image.aspect_ratio
            endif
          %}

          {%- if block.settings.image != blank -%}
            <div
              class="image-wrap content-block__image {% if block.settings.image_mask != 'none' %}svg-mask svg-mask--{{ block.settings.image_mask }}{% endif %}"
              style="display: inline-block; width: {{ block.settings.image_width }}%; margin-bottom: 20px; height: 0; padding-bottom: {{ paddingValue }}% !important;"
            >
              {%- liquid
                if section.settings.two_per_row_mobile
                  assign fallback = '50vw'
                endif
              -%}
              {% render 'image-element',
                img: block.settings.image,
                widths: '180, 360, 540, 720, 900, 1080',
                sizeVariable: section.settings.per_row,
                fallback: fallback
              %}
            </div>
          {%- endif -%}

          {%- if block.settings.button_link != blank -%}
            </a>
          {%- endif -%}

          {%- if block.settings.title != blank -%}
            <h3 class="h4">{{ block.settings.title }}</h3>
          {%- endif -%}

          {%- if block.settings.text != blank -%}
            <div class="rte-setting text-spacing">{{ block.settings.text }}</div>
          {%- endif -%}

          {%- if block.settings.button_label != blank -%}
            <a href="{{ block.settings.button_link }}" class="btn btn--tertiary btn--small">
              {{ block.settings.button_label }}
            </a>
          {%- endif -%}

        {%- elsif block.type == 'link_block' -%}
          {%- if block.settings.link != blank -%}
            <a
              class="h4 accordion-link-block__link accordion-link-block__link--arrow-{{ block.settings.show_arrow }}"
              href="{{ block.settings.link }}"
            >
              {{ block.settings.link_label }}
              {%- if block.settings.show_arrow -%}
                <span>
                  {% render 'thermos-icon-chevron-right' %}
                </span>
              {%- endif -%}
            </a>
          {%- endif -%}
        {%- elsif block.type == 'html_block' -%}
          {%- if block.settings.html != blank -%}
            {{ block.settings.html }}
          {%- endif -%}
        {%- else -%}
          {%- render block -%}
        {%- endif -%}
      </div>
    {% endfor %}
  </div>
  {% if section.settings.disabled %}
    </div>
  {% else %}
    </details>
  {% endif %}
</advanced-accordion>
